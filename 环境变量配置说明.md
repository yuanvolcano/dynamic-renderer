# ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡æ¥ç®¡ç†ä¸åŒç¯å¢ƒä¸‹çš„é…ç½®å‚æ•°ã€‚æ”¯æŒ `development`ã€`test`ã€`production` ä¸‰ä¸ªç¯å¢ƒã€‚

## ğŸ—‚ï¸ ç¯å¢ƒå˜é‡æ–‡ä»¶

| æ–‡ä»¶å               | è¯´æ˜             | Gitè·Ÿè¸ª   |
| -------------------- | ---------------- | --------- |
| `.env.development`   | å¼€å‘ç¯å¢ƒé…ç½®     | âŒ ä¸è·Ÿè¸ª |
| `.env.test`          | æµ‹è¯•ç¯å¢ƒé…ç½®     | âŒ ä¸è·Ÿè¸ª |
| `.env.production`    | ç”Ÿäº§ç¯å¢ƒé…ç½®     | âŒ ä¸è·Ÿè¸ª |
| `.env.local.example` | ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶ | âœ… è·Ÿè¸ª   |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºæœ¬åœ°ç¯å¢ƒå˜é‡æ–‡ä»¶

```bash
# å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
cp .env.local.example .env.local

# æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®
vi .env.local
```

### 2. å¯åŠ¨ä¸åŒç¯å¢ƒ

```bash
# å¼€å‘ç¯å¢ƒ
pnpm dev:h5:dev          # H5å¼€å‘ç¯å¢ƒ
pnpm dev:mp-weixin:dev   # å¾®ä¿¡å°ç¨‹åºå¼€å‘ç¯å¢ƒ

# æµ‹è¯•ç¯å¢ƒ
pnpm dev:h5:test         # H5æµ‹è¯•ç¯å¢ƒ
pnpm dev:mp-weixin:test  # å¾®ä¿¡å°ç¨‹åºæµ‹è¯•ç¯å¢ƒ

# ç”Ÿäº§ç¯å¢ƒï¼ˆç”¨äºæœ¬åœ°éªŒè¯ï¼‰
pnpm dev:h5:prod         # H5ç”Ÿäº§ç¯å¢ƒ
pnpm dev:mp-weixin:prod  # å¾®ä¿¡å°ç¨‹åºç”Ÿäº§ç¯å¢ƒ
```

### 3. æ„å»ºä¸åŒç¯å¢ƒ

```bash
# å¼€å‘ç¯å¢ƒæ„å»º
pnpm build:h5:dev
pnpm build:mp-weixin:dev

# æµ‹è¯•ç¯å¢ƒæ„å»º
pnpm build:h5:test
pnpm build:mp-weixin:test

# ç”Ÿäº§ç¯å¢ƒæ„å»º
pnpm build:h5:prod
pnpm build:mp-weixin:prod
```

## ğŸ“ ç¯å¢ƒå˜é‡è¯¦è§£

### åŸºç¡€é…ç½®

| å˜é‡å             | ç±»å‹   | è¯´æ˜     | ç¤ºä¾‹å€¼                                |
| ------------------ | ------ | -------- | ------------------------------------- |
| `VITE_APP_TITLE`   | string | åº”ç”¨æ ‡é¢˜ | `è·¨å¹³å°åŠ¨æ€UIæ„å»ºå¹³å°`                |
| `VITE_APP_VERSION` | string | åº”ç”¨ç‰ˆæœ¬ | `1.0.0`                               |
| `VITE_APP_ENV`     | string | åº”ç”¨ç¯å¢ƒ | `development` / `test` / `production` |

### APIé…ç½®

| å˜é‡å              | ç±»å‹   | è¯´æ˜                | ç¤ºä¾‹å€¼                  |
| ------------------- | ------ | ------------------- | ----------------------- |
| `VITE_API_BASE_URL` | string | APIåŸºç¡€åœ°å€         | `http://localhost:8080` |
| `VITE_API_TIMEOUT`  | number | APIè¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ | `10000`                 |

### è°ƒè¯•é…ç½®

| å˜é‡å               | ç±»å‹    | è¯´æ˜             | ç¤ºä¾‹å€¼                              |
| -------------------- | ------- | ---------------- | ----------------------------------- |
| `VITE_APP_DEBUG`     | boolean | æ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ | `true` / `false`                    |
| `VITE_APP_LOG_LEVEL` | string  | æ—¥å¿—çº§åˆ«         | `debug` / `info` / `warn` / `error` |

### å¹³å°é…ç½®

| å˜é‡å                  | ç±»å‹   | è¯´æ˜            | ç¤ºä¾‹å€¼               |
| ----------------------- | ------ | --------------- | -------------------- |
| `VITE_MP_WEIXIN_APP_ID` | string | å¾®ä¿¡å°ç¨‹åºAppID | `wx1234567890abcdef` |
| `VITE_H5_ROUTER_BASE`   | string | H5è·¯ç”±åŸºç¡€è·¯å¾„  | `/`                  |
| `VITE_H5_PUBLIC_PATH`   | string | H5é™æ€èµ„æºè·¯å¾„  | `/`                  |

### æ„å»ºé…ç½®

| å˜é‡å               | ç±»å‹    | è¯´æ˜             | ç¤ºä¾‹å€¼           |
| -------------------- | ------- | ---------------- | ---------------- |
| `VITE_DROP_CONSOLE`  | boolean | æ˜¯å¦ç§»é™¤console  | `true` / `false` |
| `VITE_DROP_DEBUGGER` | boolean | æ˜¯å¦ç§»é™¤debugger | `true` / `false` |
| `VITE_DEV_PORT`      | number  | å¼€å‘æœåŠ¡å™¨ç«¯å£   | `3000`           |

## ğŸ’» ä»£ç ä½¿ç”¨

### TypeScriptç±»å‹æ”¯æŒ

é¡¹ç›®å·²é…ç½®å®Œæ•´çš„TypeScriptç±»å‹å£°æ˜ï¼Œåœ¨ä»£ç ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡æ—¶ä¼šæœ‰æ™ºèƒ½æç¤ºï¼š

```typescript
// ç›´æ¥ä½¿ç”¨
const apiUrl = import.meta.env.VITE_API_BASE_URL;

// ä½¿ç”¨å·¥å…·å‡½æ•°ï¼ˆæ¨èï¼‰
import { getApiBaseUrl, isDev, envConfig } from '@/utils/env';

const apiUrl = getApiBaseUrl();
const isDebug = isDev();
const config = envConfig;
```

### å·¥å…·å‡½æ•°

```typescript
import {
  getAppEnv, // è·å–åº”ç”¨ç¯å¢ƒ
  isDev, // æ˜¯å¦å¼€å‘ç¯å¢ƒ
  isTest, // æ˜¯å¦æµ‹è¯•ç¯å¢ƒ
  isProd, // æ˜¯å¦ç”Ÿäº§ç¯å¢ƒ
  getAppTitle, // è·å–åº”ç”¨æ ‡é¢˜
  getApiBaseUrl, // è·å–APIåœ°å€
  isDebugMode, // æ˜¯å¦è°ƒè¯•æ¨¡å¼
  envConfig, // å®Œæ•´ç¯å¢ƒé…ç½®
} from '@/utils/env';
```

### Vueç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <view>
    <text>å½“å‰ç¯å¢ƒ: {{ envConfig.appEnv }}</text>
    <text>APIåœ°å€: {{ envConfig.apiBaseUrl }}</text>
  </view>
</template>

<script setup lang="ts">
import { envConfig } from '@/utils/env';
</script>
```

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

1. **æ•æ„Ÿä¿¡æ¯ä¿æŠ¤**:
   - æ‰€æœ‰ `.env.*` æ–‡ä»¶å·²åŠ å…¥ `.gitignore`
   - ä¸è¦åœ¨ç¯å¢ƒå˜é‡ä¸­å­˜å‚¨å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
   - ä½¿ç”¨ `VITE_` å‰ç¼€çš„å˜é‡ä¼šè¢«æ³¨å…¥åˆ°å®¢æˆ·ç«¯ä»£ç ä¸­

2. **ç”Ÿäº§ç¯å¢ƒé…ç½®**:
   - ç”Ÿäº§ç¯å¢ƒçš„ç¯å¢ƒå˜é‡åº”é€šè¿‡CI/CDæˆ–æœåŠ¡å™¨é…ç½®
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ç”Ÿäº§ç¯å¢ƒé…ç½®

3. **å¾®ä¿¡å°ç¨‹åºé…ç½®**:
   - ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„AppID
   - ç¡®ä¿æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒçš„AppIDé…ç½®æ­£ç¡®

## ğŸ› ï¸ æ•…éšœæ’é™¤

### ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ

1. æ£€æŸ¥å˜é‡åæ˜¯å¦ä»¥ `VITE_` å¼€å¤´
2. é‡å¯å¼€å‘æœåŠ¡å™¨
3. æ¸…é™¤æ„å»ºç¼“å­˜ï¼š`rm -rf dist .vite`

### TypeScriptç±»å‹é”™è¯¯

1. æ£€æŸ¥ `src/types/env.d.ts` æ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. é‡å¯TypeScriptæœåŠ¡å™¨

### æ„å»ºå¤±è´¥

1. æ£€æŸ¥ç¯å¢ƒå˜é‡è¯­æ³•æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡éƒ½å·²è®¾ç½®

## ğŸ“š æ‰©å±•é˜…è¯»

- [Vite ç¯å¢ƒå˜é‡æ–‡æ¡£](https://vitejs.dev/guide/env-and-mode.html)
- [uniapp ç¯å¢ƒå˜é‡](https://uniapp.dcloud.net.cn/collocation/env.html)
- [TypeScript ç¯å¢ƒå˜é‡ç±»å‹](https://vitejs.dev/guide/env-and-mode.html#intellisense-for-typescript)
